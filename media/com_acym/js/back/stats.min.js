jQuery(document).on("acy_preview_loaded",()=>{let _=jQuery("#acym__stats_click__map__all-links__click");if(_.length<1)return;let t=acym_helper.parseJson(_.val());jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body").prepend(jQuery("#acym__stats__add_style_export__click-map").html()),jQuery.each(t,(_,e)=>{if("allClick"===_)return;const a=jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents();let n=a.find('[href="'+_+'"]');n.length<1&&(n=a.find('[href^="'+_+'&utm_source"]')).length<1&&(n=a.find('[href^="'+_+'?utm_source"]')),n.css({position:"relative",overflow:"initial",display:"inline-block"}).append('<span class="acym__stats__cliked__link__percentage overviewbubble" style="background-color: rgba('+e.color+', 0.8);"><span class="acym__tooltip" style="display:flex;justify-content:center;align-items:center;"><span class="acym__tooltip__text"> <span class="acym__tooltip__title">'+acym_helper.sprintf(ACYM_JS_TXT.ACYM_OF_CLICKS,'<span class="acym__color__light-blue">'+e.percentage+"%</span> ")+"</span>"+acym_helper.sprintf(ACYM_JS_TXT.ACYM_CLICKS_OUT_OF,"<b>"+e.numberClick+"</b>"," <b> "+t.allClick+"</b>")+"</span>"+e.percentage+"%</span></span>")}),acym_helperTooltip.setTooltip()}),jQuery(function(_){function t(){_(".acym__stats__export__button").on("click",function(){setTimeout(function(){_("#formSubmit")[0].disabled=!1,_('[name="task"]').val("")},5)})}function e(){_(".acym__stats__export__global__charts").off("click").on("click",function(){let t=_(this),e=_("#acym__stats__export__global__charts__scope");t.attr("disabled","true"),a(e,t,"export_stats_global_")}),_(".acym__stats__export__click-map__charts").on("click",function(){let t=_(this),e=_("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body");t.attr("disabled","true"),a(e,t,"export_stats_click_map_")})}function a(t,e,a){html2canvas(t[0],{height:t.height()+100,width:t.width()+100,scrollY:-window.scrollY}).then(t=>{let n=t.toDataURL("image/png"),c=document.createElement("a"),l=new Date;c.download=a+""+l.getFullYear()+"_"+l.getMonth()+"_"+l.getDay()+".jpeg",c.href=n,c.click(),e.removeAttr("disabled"),_('[name="task"]').val("")})}!function(){let t=_("#chart__line__start"),e=_("#chart__line__end"),a=t.attr("data-start"),n=e.attr("data-end");t.val(a),e.val(n),_(".acym__stats__chart__line__input__date").off("change").on("change",function(){let a=moment(t.val(),"YYYY-MM-DD HH:mm").unix(),n=moment(e.val(),"YYYY-MM-DD HH:mm").add(1,"hours").unix();!function(t,e){let a=ACYM_AJAX_URL+"&ctrl=stats&task=setDataForChartLine&start="+t+"&end="+e+"&id="+_("#mail_id").val();_.post(a,function(t){"error"===t?acym_helperNotification.addNotification(ACYM_JS_TXT.ACYM_STATS_START_DATE_LOWER,"warning"):_("#acym__stats__chart__line__canvas").html(t)})}(a,n)})}(),t(),_('[name="export_type"]').on("change",function(){let a=_('[data-task="exportGlobal"]');a.off("click"),"charts"===_(this).val()?(a.removeClass("acy_button_submit").addClass("acym__stats__export__global__charts"),e()):(a.addClass("acy_button_submit").removeClass("acym__stats__export__global__charts"),acym_helper.setSubmitButtonGlobal()),t()}),e(),_(".acym__stats__select__language").off("change").on("change",function(){_("#formSubmit").trigger("click")}),_(".acym__stats__select__mails").on("change",function(){_(".acym__stats__select__language__container").remove()}),acym_helperStats.setLineChartOpenTimeWeek()});